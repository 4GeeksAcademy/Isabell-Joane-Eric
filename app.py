from flask import Flask, request, render_template
import numpy as np
import joblib
import pandas as pd
import os
from sklearn.pipeline import Pipeline

app = Flask(__name__)

# Load the model
model_path = os.path.join(os.getcwd(), 'final_model.joblib')
model = joblib.load(model_path)

# Dropdown values
makes = ["ACURA", "BUICK", "CADILLAC", "CHEVROLET", "CHRYSLER", "DODGE", "FORD", "GMC", "HONDA", "HUMMER", "HYUNDAI", 
         "INFINITI", "ISUZU", "JEEP", "KIA", "LEXUS", "LINCOLN", "MAZDA", "MERCURY", "MINI", "MITSUBISHI", "NISSAN", 
         "OLDSMOBILE", "PLYMOUTH", "PONTIAC", "SATURN", "SCION", "SUBARU", "SUZUKI", "TOYOTA", "TOYOTA SCION", "VOLKSWAGEN", "VOLVO"]

zip_regions = ["12", "16", "17", "19", "20", "21", "22", "23", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "37", "38", "39", "42", "43", "45", "46", "47", "48", "50", "55", "60", "62", "63", "64", "68", "70", "71", "72", "73", "74", "75", "76", "77", "78", "79", "80", "83", "84", "85", "87", "89", "90", "91", "92", "94", "95", "97", "98", "99"]
from flask import Flask, request, render_template
import numpy as np
import joblib
import pandas as pd
import os
from sklearn.pipeline import Pipeline

app = Flask(__name__)

# Load the model
model_path = os.path.join(os.getcwd(), 'final_model.joblib')
model = joblib.load(model_path)

# Dropdown values
makes = ["ACURA", "BUICK", "CADILLAC", "CHEVROLET", "CHRYSLER", "DODGE", "FORD", "GMC", "HONDA", "HUMMER", "HYUNDAI", 
         "INFINITI", "ISUZU", "JEEP", "KIA", "LEXUS", "LINCOLN", "MAZDA", "MERCURY", "MINI", "MITSUBISHI", "NISSAN", 
         "OLDSMOBILE", "PLYMOUTH", "PONTIAC", "SATURN", "SCION", "SUBARU", "SUZUKI", "TOYOTA", "TOYOTA SCION", "VOLKSWAGEN", "VOLVO"]

zip_regions = ["12", "16", "17", "19", "20", "21", "22", "23", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "37", "38", "39", "42", "43", "45", "46", "47", "48", "50", "55", "60", "62", "63", "64", "68", "70", "71", "72", "73", "74", "75", "76", "77", "78", "79", "80", "83", "84", "85", "87", "89", "90", "91", "92", "94", "95", "97", "98", "99"]

models = ["MAZDA3", "1500 RAM PICKUP 2WD", "STRATUS V6", "NEON", "FOCUS", "GALANT 4C", "SPECTRA", "TAURUS", "FIVE HUNDRED", 
          "1500 SIERRA PICKUP 2", "F150 PICKUP 2WD V6", "CARAVAN GRAND FWD V6", "ALTIMA", "CAVALIER 4C", "TRAILBLAZER 2WD 6C", 
          "VUE 2WD 4C", "IMPALA", "ENVOY XL 2WD 6C", "VOYAGER FWD V6", "MONTE CARLO", "VENTURE FWD V6", "HHR", "SABLE", 
          "ENVOY XL 4WD 6C", "DURANGO 4WD V8", "SUBURBAN 1500 2WD", "EXPLORER 2WD V6", "300", "MUSTANG V6", "AVALANCHE 1500 2WD V", 
          "WINDSTAR FWD V6", "FREESTAR FWD V6", "SONATA V6", "CALIBER", "SENTRA", "PACIFICA FWD", "IMPALA V6", "XTERRA 2WD V6", 
          "COROLLA", "G6 V6", "ION", "DURANGO 2WD V8", "FUSION 4C", "4 RUNNER 2WD V8", "GRAND PRIX", "SEBRING V6", "FORENZA", 
          "MAZDA5", "LIBERTY 2WD V6", "DAKOTA PICKUP 2WD V6", "TAHOE 2WD", "COBALT", "EXPEDITION 2WD V8", "ELEMENT 2WD", 
          "SUNFIRE", "RELAY 2WD V6", "FREESTYLE 2WD V6", "F150 PICKUP 2WD V8", "TRAILBLAZER EXT 2WD", "PT CRUISER", 
          "TRACKER 2WD V6", "DURANGO 2WD V6", "MALIBU V6", "ALERO 4C", "TOWN & COUNTRY FWD V", "CAMRY V6", "MAGNUM V6", 
          "EQUINOX FWD V6", "STRATUS 4C", "LIBERTY 2WD 4C", "MAZDA6", "CAMRY 4C", "FREESTYLE FWD V6", "L SERIES", "RENO", 
          "SEBRING 4C", "SILHOUETTE", "ESCAPE 4WD V6", "OPTIMA 4C", "RANGER PICKUP 2WD V6", "G6 4C", "ENVOY 2WD 6C", "ACCENT", 
          "UPLANDER FWD V6", "ELANTRA", "1500 SILVERADO PICKU", "PARK AVENUE", "ENDEAVOR FWD", "AMANTI", "TUCSON 2WD 4C", 
          "XB", "EXPLORER 4WD V6", "ESCAPE 2WD V6", "CARAVAN FWD V6", "TRIBUTE 2WD 4C", "SONATA 4C", "RENDEZVOUS FWD", 
          "ACCORD 4C", "ESCAPE 2WD 4C", "MALIBU MAXX V6", "COLORADO PICKUP 2WD", "REGAL", "SANTA FE 2WD V6", "GRAND CHEROKEE 2WD V", 
          "MALIBU 4C", "AVEO", "CHARGER V6", "AVENGER 4C", "RIO", "PATRIOT 4WD 4C", "SORENTO 4WD", "JOURNEY FWD 4C", "AURA", 
          "AVENGER V6", "TRIBUTE 2WD V6", "F150 PICKUP 4WD V8", "FUSION V6", "TERRAZA FWD V6", "ENDEAVOR AWD", "VIBE", 
          "TOWN & COUNTRY 2WD V", "CHARGER", "VERSA", "JETTA 5C", "SABLE 3.0L V6 EFI", "PACIFICA FWD 3.5L V6", "IMPALA 3.5L V6 SFI", 
          "COBALT 2.2L I4 MPI", "SORENTO 4WD 3.5L V6", "UPLANDER FWD V6 3.9L", "VENTURE AWD V6", "EXPEDITION 4WD V8 5.", 
          "TRACKER 4WD V6 2.5L", "MALIBU V6 3.5L V6 SF", "MUSTANG V6 4.0L V6 E", "LIBERTY 4WD V6 3.7L", "BRAVADA AWD V6 4.2L", 
          "IMPALA 3.4L V6 SFI", "CHARGER V6 2.7L V6 M", "TAURUS 3.0L V6 EFI S", "300 2.7L V6 MPI", "MONTE CARLO 3.5L V6", 
          "MAGNUM V6 2.7L V6 MP", "ION 2.2L I4 EFI / SF", "AVEO 1.6L I4 EFI", "SEBRING 4C 2.4L I4 E", "MALIBU 4C 2.2L I4 MP", 
          "FIVE HUNDRED 3.0L V6", "MALIBU MAXX V6 3.5L", "SEBRING 4C 2.4L I4 S", "SONATA V6 2.7L V6 MP", "ELANTRA 2.0L I4 MPI", 
          "MARINER 2WD V6 3.0L", "SEBRING V6 2.7L V6 M", "TRAILBLAZER 4WD 6C 4", "PT CRUISER 2.4L I4 M", "ELANTRA MFI I-4 2.0L", 
          "CAVALIER 4C 2.2L I4", "ASCENDER 2WD 6C 4.2L", "ALTIMA 2.5L I4 MPI", "HHR 2.2L I4 MPI", "STRATUS 4C 2.4L I4 S", 
          "GRAND PRIX 3.8L V6 S", "PT CRUISER 2.4L I4 S", "STRATUS 4C 2.4L I4 M", "PT CRUISER 2.4L I-4", "SANTA FE 4WD V6 2.7L", 
          "ECLIPSE", "GRAND AM V6 3.4L V6", "SONATA V6 3.3L V6 MP", "BONNEVILLE 3.8L V6 S", "EQUINOX AWD V6 3.4L", 
          "FORENZA 2.0L I4 EFI", "CONCORDE 3.5L V6 MPI", "ION 2.2L I4 EFI", "VENTURE FWD V6 3.4L", "ION 2.0L I4 MPI", 
          "SENTRA 2.5L I-4 EFI", "TAHOE 4WD 4.8L V8 SF", "SPORTAGE 2WD 4C 2.0L", "DURANGO 4WD V8 5.7L", "MALIBU V6 3.1L V6 SF", 
          "WINDSTAR FWD V6 3.8L", "ALTIMA 3.5L V6 MPI", "PACIFICA AWD 3.5L V6", "SONATA 4C 2.4L I4 MP", "VIBE 1.8L I4 MPI", 
          "MAZDA6 2.3L I4 MFI /", "EXPLORER 4WD V6 4.0L", "FOCUS 2.0L I-4 EFI D", "ACCORD V6 3.0L V6 EF", "ESCAPE 2WD V6 3.0L V", 
          "VUE AWD 4C 2.2L I4 M", "RENDEZVOUS FWD 3.4L", "ACCENT 1.6L I4 MPI", "TOWN CAR 4.6L V8 EFI", "OPTIMA 4C 2.4L I4 MP", 
          "FOCUS 2.0L I4 SFI", "MONTE CARLO 3.4L V6", "FREESTYLE 2WD V6 3.0", "MILAN V6", "LIBERTY 4WD V6", "CARAVAN FWD 4C", 
          "XL-7 4WD", "FREESTYLE AWD V6", "GRAND AM V6", "S SERIES", "PACIFICA AWD", "EQUINOX AWD V6", "HIGHLANDER 2WD V6", 
          "TRAILBLAZER EXT 4WD", "LANCER", "MAXIMA", "EXPEDITION 4WD V8", "COOPER", "ACCORD V6", "GRAND AM 4C", "MILAN 4C", 
          "ENVOY 4WD 6C", "RENDEZVOUS AWD", "CENTURY V6", "TRAILBLAZER 4WD 6C", "TRIBUTE 4WD V6", "MONTEGO", "S10 PICKUP 2WD 4C", 
          "GRAND CHEROKEE 4WD V", "1500 RAM PICKUP 4WD", "TORRENT FWD V6", "AVALANCHE 1500 4WD V", "EXPLORER 2WD V8", 
          "TAHOE 4WD", "GALANT V6", "NEON 2.0L I-4 SFI SO", "TAURUS 3.0L V6 EFI", "SPECTRA 2.0L I4 EFI", "PACIFICA FWD 3.8L V6", 
          "CHARGER V6 3.5L V6 E", "CAMRY SOLARA V6 3.0L", "RIO 1.6L I4 MPI", "CIVIC", "TRAILBLAZER 2WD 6C 4", "MAGNUM V6 3.5L V6 MP", 
          "CHARGER 3.5L V6 EFI", "LACROSSE 3.8L V6 SFI", "G6 4C 2.4L I4 MPI", "IMPALA V6 3.5L V6 SF", "MUSTANG V6 3.8L V6 E", 
          "G6 V6 3.5L V6 SFI", "RENO 2.0L I4 EFI", "CARAVAN FWD 4C 2.4L", "ACCORD 4C 2.4L I4 MP", "EXPLORER 2WD V6 4.0L", 
          "ALTIMA 2.5L I-4 EFI", "MAXIMA MFI V6 3.5L D", "300 3.5L V6 MPI", "ECLIPSE 2.4L I4 MPI", "TAURUS 3.0L V6 EFI /", 
          "LIBERTY 2WD V6 3.7L", "CHARGER 2.7L V6 MPI", "MILAN V6 3.0L V6 EFI", "FIREBIRD V6 3.8L V6", "PATRIOT 2WD 4C", 
          "RONDO V6", "FORESTER AWD", "XTERRA 2WD 4C", "DAKOTA PICKUP 2WD V8", "TIBURON", "CAMRY SOLARA V6", "MONTANA", 
          "NITRO 2WD V6", "YARIS", "G5 4C", "AURA V6", "RANGER PICKUP 2WD 4C", "SPORTAGE 2WD 4C", "MOUNTAINEER 2WD V6", 
          "CROWN VICTORIA", "ALERO V6", "300M", "GRAND CHEROKEE 4WD 6", "LE SABRE", "MATRIX 2WD", "VOYAGER FWD 4C", 
          "SENTRA 1.8L I4 EFI", "ENVOY 2WD 6C 4.2L I-", "F150 PICKUP 2WD V8 5", "ION 2.2L I4 MPI", "FREESTAR FWD V6 3.9L", 
          "MONTANA FWD 3.4L V6", "ALERO V6 3.4L V6 MPI", "COBALT 2.2L I4 MPI /", "UPLANDER FWD V6 3.5L", "VUE 2WD 4C 2.2L I4 M", 
          "GRAND VITARA 2WD 2.5", "AVEO 1.6L I-4 EFI DO", "MOUNTAINEER AWD V6 4", "XL-7 2WD 3.6L V6 EFI", "DURANGO 2WD V8 4.7L", 
          "AVEO 1.6L I4 EFI / M", "ACCORD 4C 2.4L I-4 M", "CALIBER 2.0L I4 SFI", "TAHOE 2WD 4.8L V8 SF", "F150 PICKUP 2WD V8 4", 
          "SORENTO 2WD 3.5L V6", "EQUINOX FWD V6 3.4L", "MALIBU 4C 2.2L I4 MF", "ENVOY 2WD 6C 4.2L I6", "TITAN PICKUP 2WD V8", 
          "GRAND AM 4C 2.2L I4", "ALTIMA 2.5L I4 MPI /", "AVENGER 4C 2.4L I4 S", "IMPALA 3.9L V6 SFI", "HHR 2.4L I-4 MPI", 
          "MONTANA FWD 3.5L V6", "MAXIMA 3.5L V6 MPI", "CENTURY V6 3.1L V6 S", "FUSION 4C 2.3L I4 EF", "RONDO V6 2.7L V6 DI", 
          "FREESTYLE FWD V6 3.0", "DURANGO 4WD V8 4.7L", "IMPALA V6 3.5L V6 MP", "IMPALA 3.8L V6 SFI", "LACROSSE", 
          "TUNDRA PICKUP 2WD V8", "MARINER 2WD V6", "GRAND MARQUIS", "AURA 4C", "MARINER 4WD V6", "EXPLORER AWD V6", 
          "BEETLE", "VUE 2WD V6", "YUKON XL 1500 4WD", "SONATA 4C MFI I-4 2.", "SANTA FE 2WD V6 2.7L", "NEON 2.0L I4 SFI", 
          "XG 350 3.5L V6 EFI /", "TRACKER 2WD 4C 2.0L", "GRAND CHEROKEE 2WD 6", "LANCER 2.0L I4 MPI", "MUSTANG V6 3.9L V6 E", 
          "SABLE 3.0L V6 EFI DO", "LE SABRE 3.8L V6 MFI", "SPORTAGE 2WD Multipl", "FREESTYLE AWD V6 3.0", "ESCAPE 4WD V6 3.0L V", 
          "XTERRA 2WD V6 3.3L V", "ELEMENT 2WD 2.4L I4", "EXPEDITION 2WD V8 5.", "SPECTRA 1.8L I4 EFI", "OPTIMA V6", "VUE AWD V6", 
          "BRAVADA AWD V6", "CONCORDE", "CAMRY SOLARA 4C", "FRONTIER PICKUP 2WD", "TOWN CAR", "MPV 2WD V6", "SANTA FE 2WD 4C", 
          "2500 RAM PICKUP 4WD", "PROTEGE", "CARAVAN FWD V6 3.3L", "626 V6 2.5L V6 EFI D", "S SERIES 1.9L I-4 SF", 
          "FOCUS 2.0L I4 SPI", "BONNEVILLE 3.8L V6 M", "RENO 2.0L I4 DI / EF", "INTREPID 3.5L V6 MPI", "BEETLE 2.0L I4 EFI", 
          "FOCUS 2.0L I-4 SFI S", "STRATUS V6 2.7L V6 M", "SABLE 3.0L V6 2V /EF", "ESCAPE 2WD 4C 2.0L I", "LANCER 2.4L I4 MPI", 
          "L SERIES 2.2L I4 MPI", "TACOMA PICKUP 2WD 4C", "TAURUS 3.0L V6 EFI F", "ESCAPE 2WD 4C 2.3L I", "OUTLANDER 2WD 4C 2.4", 
          "ALERO 4C 2.4L I4 SFI", "TRIBUTE 4WD V6 3.0L", "PARK AVENUE 3.8L V6", "GRAND PRIX 3.1L V6 S", "MATRIX AWD", 
          "L SERIES 2.0L I-4 MP", "ENDEAVOR FWD 3.8L V6", "FOCUS 2.3L I-4 DOHC", "MAZDA3 2.0L I-4 MPI", "ECHO 1.5L I4 EFI", 
          "PROTEGE 5 2.0L I-4 M", "RENDEZVOUS AWD 3.4L", "F150 PICKUP 2WD V6 4", "XG 350", "SANTA FE 4WD V6", 
          "TRACKER 2WD 4C", "SONOMA PICKUP 2WD V6", "HIGHLANDER 2WD 4C", "RAINIER RWD V6", "SORENTO 2WD", "MAGNUM V8", 
          "300 3.5L V6 MPI / SM", "BEETLE 2.0L I4 MFI /", "DURANGO 2WD V6 3.7L", "HHR 2.2L I-4 MPI / SF", "LACROSSE 3.6L V6 SFI", 
          "XB 1.5L I-4 EFI DOHC", "300 3.5L / 6.0L V12", "PACIFICA AWD 4.0L V6", "MAZDA6 2.3L I4 MPI", "NITRO 4WD V6 3.7L V6", 
          "PACIFICA FWD 4.0L V6", "MUSTANG V6 Unspecifi", "MONTANA FWD", "1500 SIERRA PICKUP 4", "PATRIOT FWD 4C", "AVENGER", 
          "COMMANDER 2WD V8", "MALIBU V6 3.5L V6 MF", "FORENZA 2.0L I4 DI /", "TERRAZA FWD V6 3.5L", "MAZDA6 3.0L V6 MFI /", 
          "ENVOY XL 2WD V8", "SEDONA", "ARMADA 4WD V8", "ENVOY 4WD 6C 4.2L I6", "SEBRING V6 3.0L V6 M", "RIO MFI I-4 1.6L DOH", 
          "HHR 2.2L I-4 MPI DOH", "GRAND PRIX 3.8L V6 M", "AMANTI 3.5L V6 MPI", "ALTIMA 2.4L I4 EFI", "REGAL 3.8L V6 MFI SC", 
          "TAHOE 2WD 5.3L V8 SF", "YUKON XL 1500 2WD 5.", "LE SABRE Unspecified", "LANCER 2.4L I4 EFI", "MONTANA 3.4L V6 SFI", 
          "TAHOE 4WD 5.3L V8 SF", "MONTERO SPORT 2WD V6", "MONTANA 3.4L V6 EFI", "CAMRY V6 3.0L V6 SFI", "S SERIES 1.9L I4 SFI", 
          "VIBE 1.8L I4 MFI / M", "COMMANDER 2WD V6 3.7", "4 RUNNER 2WD V8 4.7L", "SUBURBAN 1500 4WD", "COMMANDER 2WD V6", 
          "MONTEGO 3.0L V6 EFI", "G5 4C 2.2L I4 MPI", "GALANT 4C 2.4L I4 EF", "ENVOY XL 4WD V8", "MOUNTAINEER AWD V8", 
          "MOUNTAINEER AWD V6", "ASCENDER 2WD 6C", "COMMANDER 4WD V8", "ELEMENT 4WD", "CTS", "MONTEREY", "QUEST 3.5L V6 EFI /", 
          "MARINER 4WD V6 3.0L", "G6 4C 2.4L I4 MFI /", "XL-7 4WD 2.7L V6 MPI", "COMMANDER 4WD V8 4.7", "ALERO 4C 2.2L I4 MPI", 
          "DURANGO 2WD V8 5.7L", "COMMANDER 4WD V6", "HIGHLANDER 2WD V6 3.", "TAURUS X FWD V6", "2500HD SILVERADO PIC", 
          "S40", "2500 RAM PICKUP 2WD", "YUKON XL 1500 2WD", "MPV 2WD V6 3.0L V6 M", "VIBE 1.8L I-4 MPI", "SUNFIRE 2.2L I4 MPI", 
          "MOUNTAINEER 2WD V8", "AVALON", "COMPASS 4WD 4C", "DAKOTA PICKUP 4WD V6", "ASPEN 2WD V8", "MURANO 2WD V6", "QUEST", 
          "QX4 4WD V6", "MIATA MX-5", "JETTA 4C", "RIO 5", "ION 2.2L I4 MPI / SF", "EXPLORER 4WD V8", "CONTINENTAL", 
          "SRX AWD V6", "NITRO 4WD V6", "GRAND VITARA 2WD", "XA", "TAURUS 3.0L V6 SFI", "ENVOY XL 2WD 6C 4.2L", 
          "FREESTAR FWD V6 4.2L", "NEON 2.0L I4 SFI / S", "OPTIMA V6 MFI V6 2.7", "ACCENT MFI I-4 1.6L", "G6 4C 2.4L I-4 MPI", 
          "EXPEDITION 2WD V8 4.", "FOCUS 2.0L I-4 SFI D", "SEBRING 4C 2.4L I-4", "ALTIMA 2.5L I4 EFI", "EXPEDITION 4WD V8 4.", 
          "RELAY 2WD V6 3.5L V6", "SUBURBAN 1500 2WD 5.", "VITARA 2WD 4C MFI V6", "CANYON PICKUP 2WD I5", "ENVOY XL 2WD V8 5.3L", 
          "DURANGO 4WD V8 SEFI", "SENTRA 1.8L I4 EFI /", "VERONA 2.5L I6 MPI", "ALTIMA MFI I-4 2.5L", "AXIOM 2WD V6 3.5L V6", 
          "MARINER 4WD 4C", "SEBRING V6 MFI V6 2.", "COBALT 2.2L I-4 MPI", "S10 PICKUP 2WD 4C 2.", "YUKON 4WD V8 4.8L V8", 
          "S10 PICKUP 4WD V6 4.", "SPECTRA 5 2.0L I4 EF", "SANTA FE 2WD 4C 2.4L", "COLORADO PICKUP 4WD", "FOCUS 2.0L I4 EFI", 
          "AVEO 1.6L I-4 MPI DO", "SUBURBAN 1500 4WD 5.", "ECLIPSE 3.8L V6 MPI", "CAMRY 4C 2.4L I-4 SF", "SABLE 3.0L V6 4V /EF", 
          "MILAN 4C 2.3L I4 EFI", "SPORTAGE 2WD 4C 2.7L", "I-280 PICKUP 2WD 4C", "RONDO 4C", "MONTE CARLO 3.9L V6", 
          "CAMRY 4C 2.4L I4 SFI", "TRIBUTE 2WD 4C 2.3L", "IMPALA 3.5L V6 SFI F", "MONTERO SPORT 4WD V6", "YUKON 2WD V8 4.8L V8", 
          "MAGNUM V8 5.7L V8 SF", "AZERA 3.8L V6 MPI", "CANYON PICKUP 4WD I5", "PT CRUISER 2.4L I4 D", "UPLANDER AWD V6", 
          "XL-7 2WD", "GS450H", "MONTE CARLO 3.8L V6", "ELEMENT 4WD 2.4L I4", "G6 V6 3.5L V6 MFI /", "TORRENT FWD V6 3.4L", 
          "L SERIES 2.2L I4 SFI", "RENDEZVOUS FWD 3.5L", "ALERO 4C 2.2L I-4 MP", "GALANT 4C Multiple E", "COMPASS 2WD 4C 2.4L", 
          "VIBE AWD MFI I-4 1.8", "G35", "RAINIER AWD V6", "GS300", "BONNEVILLE", "ODYSSEY", "OUTLANDER AWD 4C", 
          "NAVIGATOR 4WD V8", "TORRENT AWD V6", "S10 PICKUP 2WD V6", "OPTIMA", "YUKON 2WD V8", "SABLE 3.0L V6 EFI SO", 
          "MONTEREY 4.2L V6 SPI", "AVEO 1.6L I4 DOHC", "GALANT V6 3.0L V6 EF", "SENTRA 1.8L I-4 EFI", "NAVIGATOR 2WD V8 5.4", 
          "MARINER 2WD 4C 2.3L", "300M 3.5L V6 MPI", "PROTEGE 2.0L I4 EFI", "VOYAGER FWD 4C 2.4L", "XTERRA 4WD V6 3.3L V", 
          "CAVALIER 4C 2.2L I-4", "G6 V6 3.9L V6 SFI", "OPTIMA V6 2.7L V6 MP", "GALANT V6 3.8L V6 MP", "FOCUS 2.0L I4 MFI /", 
          "RAINIER RWD V6 4.2L", "MAZDA3 2.0L I4 MFI /", "SPORTAGE 2WD V6 2.7L", "PILOT 3.5L V6 MPI", "SEDONA 3.8L V6 MPI", 
          "CAVALIER 4C 2.4L I-4", "RAINIER AWD V6 4.2L", "NITRO 2WD V6 3.7L V6", "OUTLANDER 2WD 4C", "CAMARO V6", 
          "VOYAGER FWD V6 3.3L", "XB 1.5L I4 EFI", "EXPLORER 2WD V8 4.6L", "LE SABRE 3.8L V6 MPI", "TRIBUTE 2WD V6 3.0L", 
          "VERONA 2.5L I6 DI /", "ECLIPSE 2.4L I4 EFI", "B3000 PICKUP 2WD V6", "GALANT 4C 2.4L I-4 E", "REGAL 3.8L V6 MFI", 
          "MAZDA3 2.3L I4 MFI /", "IMPALA 3.8L V6 MFI", "SPECTRA 2.0L I-4 EFI", "STRATUS V6 3.0L V6 E", "XTERRA 4WD V6", 
          "CARAVAN GRAND AWD V6", "SX4", "YUKON AWD V8", "PATHFINDER 4WD V6", "CR-V 4WD", "TUCSON 2WD V6", 
          "COMPASS FWD 4C", "PATHFINDER 2WD V6", "TUCSON 4WD 4C", "ASCENDER 4WD 6C", "SPECTRA 5", "TUCSON 4WD V6", 
          "350Z MFI V6 3.5L DOH", "GRAND VITARA 4WD 2.7", "CAMRY 4C 2.4L I-4 EF", "XL-7 4WD 2.7L V6 MFI", "TAURUS 3.0L V6 EFI D", 
          "L SERIES 3.0L V6 EFI", "AERIO 2.0L I4 EFI", "SEQUOIA 2WD 4.7L V8", "MAZDA3 2.0L I4 MPI", "ALTIMA MFI V6 3.5L D", 
          "TUCSON 2WD 4C 2.0L I", "SPORTAGE 4WD 2.0L I4", "UPLANDER AWD V6 3.5L", "MAZDA6 3.0L V6 MPI", "COMMANDER 4WD V6 3.7", 
          "ES300 3.0L V6 EFI", "ENVOY 4WD V8 5.3L V8", "COUPE 1.9L I-4 SFI D", "PATHFINDER 4WD V6 3.", "XTERRA 2WD 4C 2.4L I", 
          "L SERIES 2.0L I4 MPI", "SONOMA PICKUP 2WD 4C", "RENO 2.0L I-4 EFI DO", "TUNDRA PICKUP 4WD V8", "CONTINENTAL 4.6L V8", 
          "AURA 3.5L V6 SFI", "MPV 2WD V6 MFI V6 3.", "MONTANA AWD 3.5L V6", "MURANO AWD V6 3.5L V", "SABLE 3.0L V6 EFI 4B", 
          "CR-V 4WD 2.0L I-4 MP", "PATHFINDER 4WD V6 MF", "ECHO Multiple Engine", "300C", "SRX AWD V8 4.6L V8 S", 
          "ION 2.2L I-4 MPI DOH", "MAXIMA 3.5L V6 MPI /", "SANTA FE 2WD V6 3.5L", "IMPALA 3.8L V6 MFI S", "YUKON 4WD V8 5.3L V8", 
          "VUE 2WD 4C 2.2L I-4", "FOCUS 2.3L I4 DOHC", "TRACKER 4WD 4C", "SOLSTICE", "ZEPHYR", "TL", "YUKON 4WD V8", 
          "TRIBUTE 4WD 4C", "ESCORT 2.0L I-4 EFI", "CHEROKEE 2WD 6C 4.0L", "COMPASS 4WD 4C 2.4L", "FOCUS 2.0L I4 SFI /", 
          "MAZDA3 2.3L I4 MPI", "ESCORT 2.0L I4 EFI", "S10 PICKUP 2WD V6 MF", "DURANGO 4WD V8 5.9L", "SIERRA 1500", 
          "HHR 2.4L I4 MPI", "CAMRY 4C 2.4L I4 EFI", "TRACKER 4WD V6", "PILOT", "ES330", "SPORTAGE 4WD V6", "F150 PICKUP 4WD V6", 
          "RAIDER 2WD V6", "VIBE AWD", "AZERA", "COUPE", "AVIATOR 2WD V8", "626 V6", "GRAND MARQUIS 4.6L V", "XB 1.5L I-4 MPI", 
          "MUSTANG V8", "TC 2.4L I-4 EFI DOHC", "SCION XB", "CANYON PICKUP 2WD 4C", "SEQUOIA 2WD", "TC", 
          "YUKON 2WD V8 5.3L V8", "ESCAPE 4WD 4C 2.3L I", "TIBURON MFI I-4 2.0L", "PROTEGE MFI I-4 1.6L", "SPORTAGE 2WD V6", 
          "RANGER PICKUP 4WD V6", "ESCAPE 4WD 4C", "TRAILBLAZER 2WD V8", "AERIO", "ION 2.0L I-4 MPI DOH", "ENVOY 4WD 6C 4.2L I-", 
          "GRAND PRIX 5.3L V8 S", "HHR 2.4L I4 MPI / SF", "ALERO 4C 2.4L I-4 SF", "ASCENDER 4WD 6C 4.2L", "OUTLANDER AWD 4C 2.4", 
          "GS300 3.0L I6 EFI", "ION 2.2L I-4 EFI DOH", "ENVOY XL 4WD V8 5.3L", "MARINER 4WD 4C 2.3L", "MONTANA AWD", "TSX", 
          "ES300", "LEGACY", "LUCERNE V6", "CAMARO V6 3.8L V6 MF", "COROLLA 1.8L I4 EFI", "QUEST 3.5L V6 MPI", 
          "IMPALA V6 3.9L V6 SF", "ECLIPSE EI V6 3.0L S", "TAURUS X FWD V6 3.5L", "FUSION V6 3.0L V6 EF", "MAXIMA 3.0L V6 EFI D", 
          "CTS 3.2L V6 SFI", "MONTERO 4WD V6 3.5L", "I35 3.5L V6 MPI DOHC", "STRATUS 4C 2.4L I-4", "G20 2.0L I4 EFI", 
          "XG 350 3.5L V6 EFI D", "MOUNTAINEER AWD V8 4", "VUE AWD 4C", "300C 5.7L V8 SFI / S", "XL-7 2WD 2.7L V6 MFI", 
          "GRAND VITARA 2WD 2.7", "SUBURBAN 2500 4WD 6.", "INTREPID", "BEETLE 2.0L I4 MPI", "EXPLORER AWD V6 4.0L", 
          "MUSTANG V8 4.6L V8 E", "RX400H AWD", "SUBURBAN 2500 4WD", "F150 PICKUP 4WD V8 5", "VUE 2WD V6 3.5L V6 M", 
          "GRAND AM 4C 2.4L I-4", "PATHFINDER 2WD V6 MF", "MATRIX 2WD 1.8L I-4", "XTERRA 2WD V6 4.0L V", "MURANO 2WD V6 3.5L V", 
          "PATHFINDER 2WD V6 4.", "IMPALA 5.3L V8 SFI", "CTS 3.6L V6 SFI", "626 4C 2.0L I-4 EFI", "STRATUS V6 2.4L I-4", 
          "L SERIES 2.2L I-4 EF", "LANCER 2.0L I-4 MPI", "COROLLA 1.8L I-4 EFI", "MATRIX 2WD Multiple", "PROTEGE 2.0L I-4 EFI", 
          "SEBRING 4C 2.4L I4 M", "SPORTAGE 2WD 4C MFI", "VIBE AWD 1.8L I4 MPI", "MDX 4WD 3.5L V6 SOHC", "TUNDRA PICKUP 2WD V6", 
          "VUE 2WD V6 3.0L V6 S", "4 RUNNER 2WD V6 3.4L", "MOUNTAINEER 2WD V6 4", "ES300 3.0L V6 EFI DO", "GRAND AM V6 3.4L V 6", 
          "ACCENT 1.6L I-4 MPI", "COUPE 1.9L I-4 SFI S", "AURA V6 3.5L V6 SFI", "ACCORD 4C 2.3L I-4 E", "COOPER S", "3.2 TL", 
          "MONTERO 4WD V6", "1500HD SILVERADO PIC", "MARINER 2WD 4C", "MAZDA6 3.0L V6 MPI D", "COROLLA Multiple Eng", 
          "TUCSON 2WD V6 2.7L V", "XA 1.5L I4 EFI", "TACOMA PICKUP 2WD V6", "CELICA", "MDX 4WD", "4 RUNNER 2WD V6", "350Z", 
          "ECHO", "S60", "CARAVAN", "SILHOUETTE 3.4L V6 S", "ENDEAVOR AWD 3.8L V6", "ENVOY XL 4WD 6C 4.2L", 
          "INTREPID 2.7L V6 SFI", "CAMRY V6 3.0L V6 EFI", "CIVIC MFI I-4 1.7L S", "RAV-4 2WD Multiple E", "S10 PICKUP 4WD V6 MF", 
          "MALIBU 4C 2.4L I4 MP", "GRAND AM 4C 2.2L I-4", "FX35 AWD", "FOCUS Multiple Engin", "CAMRY V6 3.5L V6 SFI", 
          "TUCSON 4WD V6 2.7L V", "H3 3.5L I5 MPI / SFI", "VENTURE FWD V6 3.5L", "VENTURE AWD V6 3.4L", "SORENTO 2WD 3.8L V6", 
          "VUE AWD 4C 2.2L I-4", "DURANGO 2WD V8 5.9L", "IMPREZA", "DAKOTA PICKUP 2WD 4C", "MOUNTAINEER 2WD V8 4", 
          "TUCSON 2WD V6 MFI V6", "SILHOUETTE 3.4L V 6", "INTREPID 3.5L V6 EFI", "COMMANDER 2WD V8 4.7", "ACCORD 4C MFI I-4 2.", 
          "MAZDA5 2.3L I4 MFI /", "EXPLORER 4WD V8 4.6L", "SABLE 3.0L V6 EFI 2B", "YUKON XL 1500 4WD 5.", "B2300 PICKUP 2WD 4C", 
          "RAV-4 2WD", "NAVIGATOR 2WD V8", "1500HD SIERRA PICKUP", "626 4C", "SEQUOIA 4WD 4.7L V8", "3.2 CL 3.2L V 6 NA S", 
          "QX4 2WD V6 3.5L V6 M", "TIBURON 2.7L V6 MPI", "ESCORT 4-FI-2.0L", "CAMRY SOLARA 4C 2.4L", "HIGHLANDER 4WD V6", 
          "CAMRY 4C Multiple En", "TRACKER 2WD V6 2.5L", "2500 SILVERADO PICKU", "FIT", "LS V6", "CIVIC 1.7L I-4 MPI S", 
          "MURANO AWD V6", "FJ CRUISER 4WD V6", "XG 300", "F150 PICKUP 4WD V8 4", "ECLIPSE 3.0L V6 EFI", "XL-7 2WD 2.7L V6 DI", 
          "MONTERO 4WD V6 3.8L", "TRACKER 4WD 4C 2.0L", "TIBURON MFI V6 2.7L", "AERIO 2.3L I-4 SFI D", "ACCENT 1.5L I-4 EFI", 
          "2500HD SIERRA PICKUP", "SIENNA 3.0L V6 MPI", "WRANGLER 6C", "RSX", "RAV-4 4WD", "PROTEGE 5", "CARAVAN SE", 
          "CHEROKEE 2WD 6C", "CHEROKEE 4WD 6C", "B3000 PICKUP 4WD V6", "PRIZM", "300C 5.7L V8 SFI", "SRX AWD V6 3.6L V6 S", 
          "MPV 2WD V6 MFI V6 2.", "RODEO 2WD 4C MFI I-4", "AVALANCHE 2500 2WD V", "ECLIPSE 2.4L I-4 EFI", "PATHFINDER 2WD V6 3.", 
          "AVENGER V6 Unspecifi", "CAMRY SOLARA 4C Mult", "CROWN VICTORIA 4.6L", "AVIATOR 2WD V8 4.6L", "AVALON 3.0L V6 EFI D", 
          "GRAND AM V6 Unspecif", "MATRIX 2WD Unspecifi", "CR-V 4WD 2.4L I4 MPI", "ECHO 1.5L I-4 EFI DO", "MONTANA 3.4L V 6 NA", 
          "CIVIC 1.7L I4 MFI /", "TAURUS 3.5L V6 24V /", "LS V8", "SONATA 4C 2.4L I-4 M", "OUTBACK", "LS V6 3.0L V6 EFI", 
          "3.2 TL 3.2L V6 EFI", "ESCAPE", "BEETLE 2.0L I4 EFI /", "PRIZM 1.8L I-4 SFI D", "CAMRY V6 3.0L / 3.3L", 
          "DAKOTA PICKUP 4WD V8", "PATRIOT 2WD 4C 2.4L", "MAGENTIS 4C", "I30", "FIREBIRD V6", "LHS", "ENTOURAGE", 
          "RONDO V6 2.7L V6 MPI", "VERONA", "AXIOM 4WD V6 3.5L V6", "FOCUS 2.0L I-4 SPI", "VERONA 2.5L I-6 MPI", 
          "WRANGLER 6C 4.0L I-6", "3.2 TL 3.2L V6 FI DO", "F250 PICKUP 4WD V8", "RIO 5 1.6L I4 MPI", "VUE AWD V6 3.5L V6 M", 
          "REGAL 3.8L V6 SFI", "YUKON XL 1500 AWD 6.", "PATHFINDER 4WD V6 4.", "MAZDA6 2.3L I-4 MPI", "CR-V 2WD", 
          "GALANT 4C 2.4L I4 MP", "CIVIC 1.7L I4 MPI", "ZEPHYR 3.0L V6 SFI", "CAVALIER 4C 2.2L I 4", "ASCENDER 2WD V8 5.3L", 
          "RAINIER RWD V8", "FRONTIER PICKUP 4WD", "RELAY AWD V6", "ECLIPSE V6", "G35 3.5L V6 MPI", "CAMRY 4C EI I-4 2.2L", 
          "G8 V8", "TOWN & COUNTRY AWD V", "CONCORDE 2.7L V6 SFI", "LIBERTY 2WD 4C 2.4L", "AERIO 2.3L I4 SFI", "COMMANDER", 
          "CALIBER 1.8L I4 SFI", "F250 PICKUP 2WD V8", "EDGE FWD V6", "TITAN PICKUP 4WD V8", "M35", "STS V6", "CROSSFIRE 3.2L V6 MP", 
          "RAINIER AWD V8", "ENVOY 2WD V8", "TOUAREG V8", "MAZDA3 2.3L I-4 MPI", "ALTIMA Multiple Engi", "FOCUS 2.3L I4 SFI", 
          "RELAY 2WD V6 3.9L V6", "TC 2.4L I4 16V / EFI", "G35 3.5L V6 DOHC", "COOPER S 1.6L I4 EFI", "FOCUS 2.3L I4 MFI", 
          "COMPASS 2WD 4C", "RABBIT", "BRAVADA 2WD V6 4.2L", "SONATA V6 MFI V6 2.7", "GRAND VITARA 4WD", "SUNFIRE 2.2L I 4 NA", 
          "LS V6 3.0L V6 EFI DO", "RENDEZVOUS AWD 3.5L", "SEQUOIA 4WD", "SUNFIRE 2.2L I-4 MPI", "AERIO 2.3L I4 DI / S", 
          "S10 PICKUP 2WD V6 4.", "AERIO AWD", "LIBERTY 4WD 4C", "RONDO 4C 2.4L I4 DI", "EDGE AWD V6", "GRAND VITARA 4WD MFI", 
          "HIGHLANDER 2WD 4C 2.", "ESCORT", "I-370 PICKUP 2WD 5C", "ELEMENT 2WD 2.4L I-4", "XG 300 Unspecified", 
          "ESCORT 2.0L I-4 SPI", "MAGNUM V6 MFI V6 3.5", "300M 3.5L V6 MPI HO", "JOURNEY FWD V6", "ACCORD 4C 2.3L I-4 S", 
          "SEBRING V6 2.4L I4 S", "XD", "NAVIGATOR 4WD V8 5.4", "Pacifica", "TRAILBLAZER 4WD V8", "HIGHLANDER 4WD 4C", 
          "AVENGER V6 2.7L V6 M", "LUCERNE V6 3.8L V6 S", "SABLE 3.5L V6 24V /", "CONCORDE 3.2L V6 EFI", "RX300 2WD 3.0L V6 EF", 
          "ACCORD 4C 2.3L I4 EF", "RAINIER RWD V8 5.3L", "CR-V 2WD 2.0L I 4 NA", "ESCALADE 2WD", "F250 PICKUP 2WD V8 5", 
          "RX300 2WD", "STRATUS V6 2.7L V6 S", "OUTLANDER 2WD V6", "VUE AWD V6 3.0L V6 S", "IMPALA 3.5L V6 MPI /", 
          "COOPER 1.6L I-4 EFI", "AVALON 3.5L V6 EFI", "EDGE AWD V6 3.5L V6", "RAIDER 2WD V6 3.7L V", "CX-7 FWD 4C 2.3L I4", 
          "IS300", "CAMRY SOLARA V6 3.3L", "4 RUNNER 4WD V6", "RONDO 4C 2.4L I4 MPI", "MR2 SPYDER", "ARMADA 2WD V8", 
          "MALIBU HYBRID", "SENTRA 2.0L I4 EFI", "DURANGO 4WD V8 MFI V", "CHEROKEE 4WD 6C 4.0L", "626 4C 2.0L I4 EFI", 
          "YARIS 1.5L I4 EFI /", "350Z 3.5L V6 MPI", "SENTRA 1.8L I 4 NA D", "SEDONA 3.5L V6 EFI", "OPTIMA 4C 2.4L I 4 N", 
          "AVALON 3.0L V6 EFI", "COOPER 1.6L I4 EFI", "SPECTRA 6-230/250-1V", "UPLANDER", "SIENNA 3.0L V6 MPI D", 
          "4 RUNNER 4WD V6 3.4L", "SEBRING V6 2.7L V6 S", "GX470 4WD", "SIENNA", "RODEO 2WD V6", "CAMRY V6 3.0L /3.3L", 
          "I35", "AVIATOR AWD V8", "3.2 CL", "G35 3.5L V6 SMPI", "I-290 PICKUP 2WD 4C", "AXIOM 2WD V6", "COMPASS 2WD 4C 2.0L", 
          "MIRAGE 1.8L I-4 MPI", "MALIBU 4C 2.2L I-4 M", "ODYSSEY 3.5L V6 MPI", "SX4 2.0L I4 EFI", "PASSAT 4C", 
          "S10 PICKUP 4WD V6", "TAURUS X AWD V6", "SANTA FE 4WD V6 Unsp", "RX330 FWD", "M45 4.5L V8 MPI", "M35 3.5L V6 MPI", 
          "HIGHLANDER 4WD V6 3.", "BRAVADA 2WD V6", "LS V8 3.9L V8 EFI", "MDX 4WD 3.5L V6 EFI", "CX-7 AWD 4C", 
          "VITARA 2WD 4C 2.0L I", "CX-7 FWD 4C", "ALTIMA 3.5L V6 MPI /", "EXCURSION 4WD V8 5.4", "M45 4.5L V8 MPI / SF", 
          "PATRIOT 2WD 4C 2.0L"]

@app.route('/')
def home():
    return render_template('index.html', makes=makes, zip_regions=zip_regions, models=models)

@app.route('/predict', methods=['POST'])
def predict():
    # Collect all relevant features from the form
    input_data = {feature: request.form.get(feature, 'nan') for feature in model.feature_names_in_ if feature not in ['IsBadBuy']}
    
    # Convert numeric fields and ensure data types match training
    numeric_fields = [field for field in input_data if input_data[field].replace('.', '', 1).isdigit()]
    for field in numeric_fields:
        input_data[field] = float(input_data[field])
    
    # Vehicle Age calculation, if necessary
    if 'VehYear' in input_data and 'VehicleAge' not in input_data:
        input_data["VehicleAge"] = 2024 - int(input_data["VehYear"])
    
    # Prepare DataFrame for model
    data = pd.DataFrame([input_data])

    # Ensure the DataFrame matches the training features, including dummy variables for categories
    for col in model.feature_names_in_:
        if col not in data:
            data[col] = 0  # Assuming missing categorical columns should be zero (for one-hot encoding)
    
    # Make prediction
    prediction = model.predict(data)
    prediction_text = "This is a Good Buy" if prediction[0] == 0 else "This is a Bad Buy"
    
    return render_template('index.html', prediction_text=prediction_text, makes=makes, zip_regions=zip_regions, models=models)

if __name__ == "__main__":
    app.run(debug=True)